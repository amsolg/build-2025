# LAB233 - Extend Microsoft 365 Copilot with Declarative Authoring using Teams Toolkit

## Date
2025-05-19

## Overview
LAB233 provided hands-on experience building, testing, and publishing declarative agents for Microsoft 365 Copilot using the Agents Toolkit and TypeSpec. This lab introduced attendees to the declarative authoring approach for creating custom Copilot agents that extend Microsoft 365 functionality through natural language interactions.

## Details

### What is being described or announced?
- **Declarative Agents for Microsoft 365 Copilot**: A new approach to building intelligent agents that extend Copilot's capabilities through declarative configuration rather than imperative code
- **Teams Toolkit Integration**: Enhanced developer experience for creating, testing, and deploying Copilot agents using familiar Visual Studio Code tools
- **TypeSpec Support**: Modern API definition language for describing agent behaviors, data models, and integration points
- **Agents Toolkit**: Comprehensive development environment for building and managing Microsoft 365 Copilot extensions

### Who is impacted or involved?
- **Microsoft 365 Developers**: Building custom business solutions and workflow automation
- **Enterprise Organizations**: Seeking to customize Copilot for specific business processes and data sources
- **ISVs and Partners**: Creating commercial Copilot extensions and marketplace offerings
- **IT Administrators**: Managing and deploying custom agents within organizational boundaries

### Why is this important?
- **Democratizes AI Development**: Enables developers to create sophisticated AI agents without deep machine learning expertise
- **Accelerates Business Value**: Reduces time-to-market for custom Copilot solutions from months to weeks
- **Maintains Security and Compliance**: Ensures custom agents respect organizational data boundaries and security policies
- **Scales Copilot Adoption**: Enables organizations to tailor Copilot for industry-specific and business-specific use cases

### Key Features, Changes, or Steps

#### Attendee Activities
1. **Environment Setup**: Configured Teams Toolkit with Agents Toolkit extensions in Visual Studio Code
2. **Agent Creation**: Built declarative agents using TypeSpec to define:
   - Agent personalities and instructions
   - Data source connections and permissions
   - Natural language command interfaces
   - Integration with Microsoft Graph APIs
3. **Testing and Debugging**: Used local development tools to test agent responses and refine behaviors
4. **Publishing Workflow**: Deployed agents to Microsoft 365 environments using automated CI/CD pipelines
5. **Advanced Scenarios**: Implemented multi-turn conversations, context awareness, and complex data retrieval patterns

#### Learning Outcomes
- **Declarative vs. Imperative Development**: Understanding when and how to use configuration-based agent development
- **TypeSpec Proficiency**: Writing type-safe API definitions for agent behaviors and data models
- **Microsoft Graph Integration**: Connecting agents to organizational data while respecting security boundaries
- **Agent Lifecycle Management**: Best practices for versioning, testing, and maintaining Copilot extensions
- **Performance Optimization**: Techniques for building responsive and efficient agent interactions

#### Technical Implementation
- **Agent Definition**: Used TypeSpec to declaratively define agent capabilities, permissions, and behavioral constraints
- **Data Integration**: Connected agents to SharePoint, Teams, Outlook, and custom line-of-business systems
- **Security Model**: Implemented proper authentication, authorization, and data access controls
- **Testing Framework**: Leveraged built-in testing tools for validating agent responses and performance
- **Deployment Pipeline**: Automated publishing process with staging, validation, and production deployment stages

## Links & Resources

- [Build session LAB233](https://build.microsoft.com/en-US/sessions/LAB233)
- [Microsoft Docs: Build declarative agents with TypeSpec](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/build-declarative-agents-typespec)
- [Training Series: Build declarative agents for Microsoft 365 Copilot using Visual Studio Code](https://learn.microsoft.com/en-us/training/paths/copilot-microsoft-365-declarative-agents-visual-studio-code/)
- [Teams Toolkit Documentation](https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)
- [TypeSpec Language Reference](https://typespec.io/)
- [Microsoft 365 Copilot Extensibility Documentation](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/)

> Referenced in: [keynotes/KEY010.md](../keynotes/KEY010.md), [announcements/copilot-everywhere.md](../announcements/copilot-everywhere.md)
